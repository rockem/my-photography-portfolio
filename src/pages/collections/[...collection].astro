---
import MainLayout from '../../layouts/MainLayout.astro';
import PhotoGrid from '../../components/PhotoGrid.astro';
import { getCollections, getImages } from '../../data/imageStore';

const collections = await getCollections();
let { collection } = Astro.params;

const collectionName = collections.find((col) => col.id === collection)?.name;

const images = collection
	? await getImages({ collection: collection, sortBy: 'captureDate', order: 'desc' })
	: [];

export const getStaticPaths = async () => {
	return [{ id: undefined }, ...(await getCollections())].map((collection) => {
		return {
			params: { collection: collection.id },
		};
	});
};
---

<MainLayout>
	<section class="py-16 pt-24">
		<div class="container-custom">
			<div class="mb-16 text-center">
				<h1 class="text-4xl md:text-5xl font-bold mb-4">{collectionName}</h1>
			</div>

			<PhotoGrid images={images} />
		</div>
	</section>
</MainLayout>
